webpackJsonp([0,2],{48:function(t,e){"use strict";function s(t){return t.boards.pgn}function o(t){return t.boards.turn}function i(t){var e={white:t.boards.twhite,black:t.boards.tblack};return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getGamePgn=s,e.getGameTurn=o,e.getGameTimesUsers=i},88:function(t,e){"use strict";function s(t){return function(e){for(var s=arguments.length,o=Array(s>1?s-1:0),i=1;s>i;i++)o[i-1]=arguments[i];var n=e.dispatch;return n.apply(void 0,[t].concat(o))}}Object.defineProperty(e,"__esModule",{value:!0});e.boardGameMove=s("MOVE"),e.boardGameTurn=s("TURN"),e.boardGameCountDown=s("COUNTDOWN")},95:function(t,e,s){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(18),n=o(i),a=s(22),r=o(a),c=s(20),d=o(c),h=s(42),l=o(h),u=s(225),m=o(u),v=s(78),f=o(v),b=s(80),p=o(b),g=s(2),A=o(g),w=s(3),C=o(w),y=s(88),x=s(48),B=s(69),k=o(B),G=s(17),_=o(G),T={white:1,black:1},M={board:["light-wood-3d","blue","wood","marble"],pieces:["merida","staunton","pirouetti","cburnett"]};e["default"]={template:s(216),route:{canActivate:function(t){return C["default"].user_acces("authenticate")&&A["default"].get("board")._id?!0:t.redirect("home")}},data:function(){return{chattext:"",mensjGame:[],user:C["default"].getUser(),ground:0,fen:"none",orientation:"white",history:[],styleboard:!0,active:!0,state:"",chess:new d["default"],stylesBoard:M,styles:A["default"].get("styleBoard",{board:1,pieces:0}),board:A["default"].get("board"),dirServer:A["default"].get("serverDir")}},mixins:[_["default"]],props:{},components:{UserCard:m["default"],BoardHistory:f["default"],BodyMen:p["default"]},vuex:{actions:{boardGameMove:y.boardGameMove,boardGameTurn:y.boardGameTurn,boardGameCountDown:y.boardGameCountDown},getters:{pgn:x.getGamePgn,turn:x.getGameTurn,time:x.getGameTimesUsers}},events:{move:function(t){this.active&&this.boardGameMove(t.pgn),this.changeStateGame(t.pgn,t.move),t.times&&(this.boardGameCountDown(t.times.black,"black"),this.boardGameCountDown(t.times.white,"white"))},gameFinish:function(t){this.stateFinishGame(t)},mensaje:function(t){this.recibeMensaje(t.men)}},methods:{recibeMensaje:function(t){var e="chatConvertGame",s=document.getElementById(e),o=s.scrollTop>=s.scrollHeight-s.clientHeight;this.mensjGame.push(t),o&&setTimeout(function(){(0,k["default"])("#"+e).animate({scrollTop:(0,k["default"])("#"+e)[0].scrollHeight},"slow")},10)},loadUserConvert:function(t){var e={c:"chat",f:"loadUserConvert",data:t};this.$socket.emit("event",e,function(){var t=arguments.length<=1?void 0:arguments[1];this.mensjGame=t,setTimeout(function(){(0,k["default"])("#chatConvertGame").animate({scrollTop:(0,k["default"])("#chatConvertGame")[0].scrollHeight},"slow")},1e3)}.bind(this))},sendMensaje:function(){var t=C["default"].getUser().username,e=this.board.u1===t?this.board.u2:this.board.u1;if("PC"!==e&&""!==this.chattext){var s={body:this.chattext,type:"text","public":!1,send:t,recibe:e},o={c:"chat",f:"mensaje",data:{men:s}};this.$socket.emit("event",o,function(){}),this.chattext=""}},countDown:function(){var t=0;if(t=this.time[this.turn]-1,0>=t&&(t=0,clearInterval(T[this.turn]),this.active)){var e={color:"black"===this.turn?"white":"black",motiv:"timeout"};this.gameFinish(e)}this.boardGameCountDown(t,this.turn)},countDownStart:function(){clearInterval(T[this.turn]),T[this.turn]=setInterval(function(){this.countDown()}.bind(this),1e3)},chessToDests:function(t){var e={};return t.SQUARES.forEach(function(s){var o=t.moves({square:s,verbose:!0});o.length&&(e[s]=o.map(function(t){return t.to}))}),e},chessToColor:function(t){var e=t.turn(),s="w"===e?"white":"black";return this.boardGameTurn(s),s=C["default"].getUser().username===this.board.u2?"black":"white"},onMove:function(t,e){if(this.active){this.chess.move({from:t,to:e,promotion:"q"});var s="w"===this.chess.turn()?"white":"black",o={c:"board",f:"move",data:{event:"move",data:{pgn:this.chess.pgn(),idBoard:this.board._id,turn:s,times:{},move:{from:t,to:e}}}};this.$socket.emit("event",o,function(){})}},PcIngeniesMove:function(t){var e=255&t,s=t>>8&255,o=l["default"].FormatSquare(e),i=l["default"].FormatSquare(s);this.onMove(o,i)},pcMove:function(t){l["default"].InitializeFromFen(t),l["default"].Search(this.PcIngeniesMove,5,null)},isVsPc:function(t){("white"===t&&"PC"===this.board.u1||"black"===t&&"PC"===this.board.u2)&&setTimeout(function(){this.pcMove(this.chess.fen())}.bind(this),700)},isHumanVsPC:function(){return"PC"===this.board.u1||"PC"===this.board.u2},changeStateGame:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e.from?(this.chess.move({from:e.from,to:e.to,promotion:"q"}),this.ground.move(e.from,e.to)):this.chess.load_pgn(t),this.ground.set({fen:this.chess.fen(),turnColor:this.chessToColor(this.chess),movable:{color:this.chessToColor(this.chess),dests:this.chessToDests(this.chess)}}),this.isVsPc(this.turn)},changeOrientation:function(){this.orientation="white"===this.orientation?"black":"white",this.ground.set({orientation:this.orientation})},changeStyle:function(t){this.styles[t]=this.styles[t]+1,this.styles[t]>M[t].length-1&&(this.styles[t]=0),this.styleAdapter(),A["default"].set("styleBoard",this.styles)},styleAdapter:function(){"light-wood-3d"===this.stylesBoard.board[this.styles.board]?document.getElementById("tablerochess").style.height=document.getElementById("tablerochess").clientWidth-6.25*document.getElementById("tablerochess").clientWidth/100+"px":document.getElementById("tablerochess").style.height=document.getElementById("tablerochess").clientWidth+"px"},initGame:function(){this.boardGameMove("none");var t={c:"board",f:"getBoard",data:A["default"].get("board")};this.$socket.emit("event",t,function(){for(var t=arguments.length,e=Array(t),s=0;t>s;s++)e[s]=arguments[s];if(e[0])return A["default"].del("board"),void this.$route.router.go("/");var o=e[1].board;this.boardGameCountDown(e[1].times.black,"black"),this.boardGameCountDown(e[1].times.white,"white"),this.changeStateGame(o.pgn),this.boardGameMove(o.pgn),this.board=o,this.styleAdapter()}.bind(this));var e=C["default"].getUser().username,s=this.board.u1===e?this.board.u2:this.board.u1,o={user:s,range:{limit:10,skip:0}};this.loadUserConvert(o)},gameState:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(t.motiv){if("checkmate"===t.motiv)return"checkmate "+n["default"].t("game.wins")+" "+t.color;if("drawn_position"===t.motiv)return"drawn_position "+n["default"].t("game.wins")+" "+t.color;if("rendicion"===t.motiv)return n["default"].t("game.wins")+" "+t.color+" "+n["default"].t("game.motives.rendi");if("timeout"===t.motiv)return this.boardGameCountDown(0,"white"===t.color?"black":"white"),n["default"].t("game.wins")+" "+t.color+" "+n["default"].t("game.motives.time")}if(this.chess.in_checkmate()){var e={color:"white"===this.turn?"black":"white",motiv:"checkmate"};return void this.gameFinish(e)}if(this.chess.in_draw()){var s={color:this.turn,motiv:"drawn_position"};return void this.gameFinish(s)}return this.chess.in_check()?this.turn+n["default"].t("game.check"):n["default"].t("game.turnColor")+" "+this.turn},rendir:function(){var t={color:this.board.u1===C["default"].getUser().username?"black":"white",motiv:"rendicion"};this.gameFinish(t)},gameFinish:function(t){if(this.active){var e={c:"board",f:"gameFinish",data:{idBoard:this.board._id,result:t}};this.$socket.emit("event",e,function(){})}},stateFinishGame:function(t){this.active=!1,this.state=this.gameState(t.result),A["default"].del("board"),this.ground.stop(),clearInterval(T.black),clearInterval(T.white)}},created:function(){l["default"].ResetGame(),setTimeout(function(){this.orientation=C["default"].getUser().username===this.board.u2?"black":"white",this.ground=(0,r["default"])(document.getElementById("tablerochess"),{viewOnly:!1,turnColor:"white",animation:{duration:300},movable:{free:!1,premove:!0,dests:this.chessToDests(this.chess),events:{after:this.onMove}},drawable:{enabled:!0},showDests:!0,orientation:this.orientation}),this.styleAdapter(),this.initGame(),(0,k["default"])("html, body").animate({scrollTop:(0,k["default"])("#tablerochess").offset().top},500)}.bind(this),10)},watch:{turn:function(t,e){this.active&&(clearInterval(T[e]),this.countDownStart())},pgn:function(t,e){this.state=this.gameState(),this.history=this.chess.history({verbose:!0})}}}},96:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s(48);e["default"]={name:"userCard",props:{color:{type:String},username:{type:String}},vuex:{getters:{turn:o.getGameTurn,time:o.getGameTimesUsers}},methods:{pad:function(t,e){return("0"+t).slice(e)}},filters:{boardTime:function(t){var e=parseInt(t/60),s=t%60;return this.pad(e,-2)+":"+this.pad(s,-2)}},watch:{},created:function(){}}},156:function(t,e,s){e=t.exports=s(65)(),e.push([t.id,".menText p[_v-43c15f1a]{text-align:justify;-moz-hyphens:auto;word-wrap:break-word}.userTurn[_v-43c15f1a]{background-color:#d8b980}.send-btn[_v-43c15f1a]{height:60px}.chessground.tiny[_v-43c15f1a]{width:225px;height:225px}.chessground.small[_v-43c15f1a]{width:300px;height:300px}.chessground.normal[_v-43c15f1a]{width:512px;height:512px}.cg-board-wrap svg[_v-43c15f1a]{opacity:.6;overflow:hidden;position:relative;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:2}.cg-board-wrap svg [_v-43c15f1a]{-webkit-transition:.35s;transition:.35s}","",{version:3,sources:["/./src/components/game/index.vue"],names:[],mappings:"AACA,wBACE,mBAAoB,AACpB,kBAAmB,AACnB,oBAAsB,CACvB,AAED,uBACE,wBAA0B,CAC3B,AACD,uBACE,WAAa,CACd,AAED,+BACE,YAAa,AACb,YAAc,CACf,AACD,gCACE,YAAa,AACb,YAAc,CACf,AACD,iCACE,YAAa,AACb,YAAc,CACf,AACD,gCACE,WAAa,AACb,gBAAiB,AACjB,kBAAmB,AACnB,MAAS,AACT,OAAU,AACV,WAAY,AACZ,YAAa,AACb,oBAAqB,AACrB,SAAW,CACZ,AACD,iCACE,wBAA0B,AAC1B,eAAkB,CACnB",file:"index.vue",sourcesContent:["\n.menText p[_v-43c15f1a]{\n  text-align: justify;\n  -moz-hyphens: auto;\n  word-wrap: break-word;\n}\n\n.userTurn[_v-43c15f1a] {\n  background-color: #D8B980;\n}\n.send-btn[_v-43c15f1a]{\n  height: 60px;\n}\n\n.chessground.tiny[_v-43c15f1a] {\n  width: 225px;\n  height: 225px;\n}\n.chessground.small[_v-43c15f1a] {\n  width: 300px;\n  height: 300px;\n}\n.chessground.normal[_v-43c15f1a] {\n  width: 512px;\n  height: 512px;\n}\n.cg-board-wrap svg[_v-43c15f1a] {\n  opacity: 0.6;\n  overflow: hidden;\n  position: relative;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  z-index: 2;\n}\n.cg-board-wrap svg *[_v-43c15f1a] {\n  -webkit-transition: 0.35s;\n  transition: 0.35s;\n}\n"],sourceRoot:"webpack://"}])},172:function(t,e,s){var o=s(156);"string"==typeof o&&(o=[[t.id,o,""]]);s(81)(o,{});o.locals&&(t.exports=o.locals)},207:function(t,e,s){t.exports='<div class="col s12 m12 l12 card-panel" v-bind:class="[turn === color ? \'userTurn\' : \'\']"> <div class="col s4 m4 l3"> <h4 class=flat-text-header>{{ time[color] | boardTime }}</h4> </div> <div class="col s4 m4 l6"> <p class=flat-text-header style="float: right">{{ username }}</p> </div> <div class="col s4 m4 l3"> <img alt="" src='+s(46)+' class="avatar avatar-50 photo avatar-default" height=50 width=50> </div> </div>'},216:function(t,e){t.exports='<div class="col s12"> <div class="col s12 m12 l3"> <p class=flat-text-header>{{ $t("game.chat") }}</p> <div style="height: 65vh;overflow: auto" id=chatConvertGame> <body-men :mens=mensjGame :dir-server=dirServer></body-men> </div> <form v-on:submit.prevent=sendMensaje()> <md-input name=text :value.sync=chattext class="col s9 m9 l10"> {{ $t("game.text") }} </md-input> <md-btn @mouseover="tooltip($event, \'Enviar Mensaje\', \'top\')" class="btn waves-effect waves-light col s3 m3 l2 send-btn" type=submit> S </md-btn> </form> </div> <div class="col s12 m12 l6"> <div id=tablerochess style="width: 100%;height: 600px" class="{{ stylesBoard[\'board\'][styles[\'board\']] }} chessground vuejs {{ stylesBoard[\'pieces\'][styles[\'pieces\']] }}"></div> </div> <div class="col s12 m12 l3"> <user-card :color="\'white\'" :username=board.u1 v-if="this.orientation === \'black\'"></user-card> <user-card :color="\'black\'" :username=board.u2 v-else></user-card> <h6 class="flat-text-header hello" style="text-align: center">{{ state }}</h6> <div class="col s12 m12 l12"> <board-history :history=history :active=active :humanvspc=isHumanVsPC></board-history> </div> <div class="col s12 m12 l12"> <md-btn @mouseover="tooltip($event, \'Pieces\', \'top\')" class="waves-effect waves-light col s2 m2 l2" @click="changeStyle(\'pieces\')"> P </md-btn> <md-btn @mouseover="tooltip($event, \'Board\', \'top\')" class="waves-effect waves-light col s2 m2 l2" @click="changeStyle(\'board\')"> B </md-btn> <md-btn @mouseover="tooltip($event, \'Rendirse\', \'top\')" class="waves-effect waves-light col s4 m4 l4" @click=rendir()> {{ $t("game.rend") }} </md-btn> <md-btn @mouseover="tooltip($event, \'Cambiar orientacion\', \'top\')" class="waves-effect waves-light col s4 m4 l4" @click=changeOrientation> {{ $t("game.invert") }} </md-btn> </div> <user-card :color="\'black\'" :username=board.u2 v-if="this.orientation !== \'white\'"></user-card> <user-card :color="\'white\'" :username=board.u1 v-else></user-card> </div> </div>'},224:function(t,e,s){var o,i;s(172),o=s(95),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),i&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=i)},225:function(t,e,s){var o,i;o=s(96),i=s(207),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),i&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=i)}});
//# sourceMappingURL=0.7d13f8aa6946fc82cf72.js.map